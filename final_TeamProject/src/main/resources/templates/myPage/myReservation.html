<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src='https://code.jquery.com/jquery-3.6.3.min.js'></script>
<script type="text/javascript">
/* $(function(){
	$("#goToreview").click(function(event){
		
	});
}); */

function review_chk(id,accommoNo,date_e){
	const today = new Date();
	/* let year = today.getFullYear(); // 년도
	let month = today.getMonth() + 1;  // 월
	let date = today.getDate();  // 날짜
	let day = today.getDay();  // 요일
	 */
	
	var input_date = new Date(date_e);
	 
	var myid = id;
	
	console.log(today);
	console.log(input_date);
	
	
	if(input_date >= today){
		alert("기간이 지나야 리뷰를 작성할수 있습니다.")
	}else{
		$.ajax({
			url:"/myPage/review_chk",
			data:{"id":myid, "accommono":accommoNo},
			success:function(data){
				if(data == 0){
					 location.href = "/myPage/reviewInsert?id="+id+"&accommoNo="+accommoNo;
				} else{
					alert("이미 작성한 리뷰입니다.")
				}	
					
			}
			
			});
	}
	
}
</script>
</head>
<body>
<table>
<thead>
	<th>예약일</th>
	<th>상품</th>
	<th>금액</th>
	<th></th>
</thead>
<tbody>
	<tr th:each="r:${list}" class="list">
		<td th:text="${r.date_s}+' ~ '+ ${r.date_e}"></td>
		<td th:text=${r.name}></td>
		<td th:text=${r.totalPrice}></td>
		<td><button th:text='리뷰남기기' th:id="${session.id}" th:accommoNo="${r.accommoNo}" th:date_e="${r.date_e}" th:onclick="review_chk(this.getAttribute('id'),this.getAttribute('accommoNo'),this.getAttribute('date_e'))"></button></td>
	</tr>
	


</tbody>
</table>

<th:block th:each="i:${#numbers.sequence(1,totalPage)}">
		<a th:text="${i}" th:href="'/myPage/myReservation?pageNUM='+${i}"></a>
</th:block>
</body>
</html>